% Professional Report Template for Pandoc
% Optimized for technical documentation and reports
%
% Usage:
%   pandoc document.md -o document.pdf \
%     --template=report-template.tex \
%     --pdf-engine=xelatex

\documentclass[12pt,a4paper]{article}

% Packages
\usepackage{geometry}
\usepackage{fontspec}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{tcolorbox}
\usepackage{amsmath}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{setspace}

% Page geometry
\geometry{
  top=1in,
  bottom=1in,
  left=1.25in,
  right=1.25in
}

% Fonts
\setmainfont{Arial}
\setmonofont{Consolas}[Scale=0.9]

% Colors
\definecolor{linkcolor}{RGB}{0, 102, 204}
\definecolor{codebackground}{RGB}{245, 245, 245}
\definecolor{codeborder}{RGB}{204, 204, 204}

% Hyperlinks
\hypersetup{
  colorlinks=true,
  linkcolor=linkcolor,
  urlcolor=linkcolor,
  citecolor=linkcolor,
  pdfborder={0 0 0},
  breaklinks=true
}

% Headers and footers
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\nouppercase{\leftmark}}
\fancyhead[R]{\small\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% Title formatting
\titleformat{\section}
  {\Large\bfseries\color{black}}
  {\thesection}{1em}{}

\titleformat{\subsection}
  {\large\bfseries\color{black}}
  {\thesubsection}{1em}{}

\titleformat{\subsubsection}
  {\normalsize\bfseries\color{black}}
  {\thesubsubsection}{1em}{}

% Code listings
\lstset{
  backgroundcolor=\color{codebackground},
  basicstyle=\ttfamily\small,
  breaklines=true,
  frame=single,
  rulecolor=\color{codeborder},
  xleftmargin=0.5cm,
  xrightmargin=0.5cm,
  aboveskip=1em,
  belowskip=1em,
  columns=flexible,
  keepspaces=true,
  showstringspaces=false
}

% Line spacing
\setstretch{1.2}

% Paragraph spacing
\setlength{\parskip}{0.5em}
\setlength{\parindent}{0pt}

% Pandoc variables
$if(title)$
\title{$title$}
$endif$

$if(author)$
\author{$author$}
$endif$

$if(date)$
\date{$date$}
$endif$

% Document
\begin{document}

$if(title)$
\maketitle
\thispagestyle{empty}
\clearpage
$endif$

$if(toc)$
\tableofcontents
\clearpage
$endif$

$body$

\end{document}
